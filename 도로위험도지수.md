# 도로위험도지수

## <좌표 정하기>

- kml 파일 이용
- <b>[폐기]</b>API 이용 방법 - kml파일에 임의의 gps좌표를 입력한다면
  1. 전체 DB검색으로 구간 안에 있는지 부등호 계산 (`DB가 커서 시간 너무 오래걸림`)
  2. gps -> 지오코딩으로 고속도로 구간 확인 -> API 호출(REST API) -> 약 50개 구간 부등호 계산(`일반화-나중에 구현`/ `지오코딩 때문에 시간이 걸릴 수 있음`)
  3. 세부링크 도로위험도지수정보 조회 서비스 API 사용: 위도, 경도 맨 마지막 문자열 1씩 증가시켜서 구간 정하기 - `가능성 있는 문제상황`: 구간 내에 두 개의 위험도 생김(=>맨 위에 하나만 고르면 됨)
- <b>[폐기]</b>방법2 - kml파일에 임의의 gps좌표를 입력하지 않고, 2~3개 직선 구간을 미리 정해두고 좌표도 부등호 계산 없이 경계값으로 설정
  1. gps - API셋 설정(지오코딩X. 사람이 직접 gps좌표 개수 줌) -> API호출(REST API) -> 약 50개 == 계산 (`일단 구현`)

## <시군구 데이터 이용하기>

- 링크  단위길이(1km) 당 DB에는 시간대, 날씨, 사용자 나이, 성별 등 대부분의 정보가 없으므로 `GIS의 시군구 데이터` 이용

  => 기준은 어떻게 정하냐에 따라 달라지는데, 원래 지수에서 단위길이로 구했던 이유는 구간 길이가 길어질수록 사고발생횟수가 높아질 것이라는 가정 때문

- 그런데 `GIS의 시군구 데이터`에는 교통소통정보가 없음 

  ->  국가교통정보센터(http://www.its.go.kr/stats/trfflow/trfflow.route.do)에서 따로 관리하므로 합치는 작업 필요(2018년~2019년의 2년*365일 = 730개 DB를 크롤링하고, 교통사고 데이터를 하둡으로 1년, 1개월 단위로 쪼개서 날짜와 시간에 맞게 정렬해서 교통소통정보와 하나씩 매칭시켜야 할 듯)

  -> 여건상 `소통상황 '원활'` 가정. <b>영향변수 2개 사용(기상, 주야시간대)</b>

## <영향변수>

- TAAS의 도로위험도지수에서 선출한 3개 영향변수(기상, 소통상황, 주야시간대) 사용

  => 선정 방법: 문의결과 이전 버전에서 전문가들이 지정한 변수. 카이제곱검정을 사용했는지 더 자세한 것은 모름

## <도로위험도 평가 매트릭스>

- `0 : 0%`

  `가장 큰 위험도지수: 100%` 

  로 정하고 0~15%: 안전/ 15~50%: 주의/ 50~85%: 위험/ 85~100%: 심각

## <다중선형회귀>

- 도로별/차종별(고속도로/화물차) data set 고정 => `도로위험도basic`을 target으로 해서 linear regression
- 성별(남/여), 요일 등 data set을 따로 뽑아서 linear regression 여러번 돌리기

## <DB 데이터>

- gps -> 지오코딩으로 시군구 변환 -> 오라클DB에 저장되어 있는 `위험도지수basic(1년간 고정값임. 2019년)` 불러오고 날씨API로 날씨 불러와서 계산(주야시간대는 java의 메소드 이용)

  => 따라서 위험도지수basic을 따로 구해야 한다.(최근 2년 데이터만 모아서 계산)

## <수정계수>

- 영향변수의 계수를 구한 후, 선형회귀 공식을 곱셈공식으로 바꾸기 위해 
- `default계수(소통-원활, 기상-맑음, 시간대-주간)`를 1.0으로 잡고 나머지 계수를 상대값으로 변환.
- 회귀식 -> 곱하기로 변환